{
  "id": "guide/migration-legacy-message-id",
  "title": "Migrating legacy localization IDs",
  "contents": "\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-legacy-message-id.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"migrating-legacy-localization-ids\" translation-result=\"on\">迁移旧版本地化 ID<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrating-legacy-localization-ids\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\" id=\"migrating-legacy-localization-ids\">Migrating legacy localization IDs<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrating-legacy-localization-ids\"><i class=\"material-icons\">link</i></a></h1>\n\n<h2 id=\"why-this-migration-is-necessary\" translation-result=\"on\">为什么需要进行迁移<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#why-this-migration-is-necessary\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"why-this-migration-is-necessary\">Why this migration is necessary<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#why-this-migration-is-necessary\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">Angular 的翻译体系会根据消息 ID 与另一种语言的译后消息进行匹配。创建这些 ID 的方法之一是让翻译体系为你生成它们。以前，这些 ID 的格式在发生细微更改时（例如，加减空格）是不稳定的。而新格式会更加稳健。</p><p translation-origin=\"off\">The Angular translation system works by matching a message ID to a translated message in a different language. One option for creating these IDs is to have the translation system generate them for you. Previously, the format for these IDs are not stable when there are insignificant changes, such as to whitespace. The new format is much more robust.</p>\n\n<p translation-result=\"on\">本主题描述了如何迁移旧的本地化 ID，来帮你提前适应完全停止支持旧格式的那一刻。</p><p translation-origin=\"off\">This topic describes how to migrate old localization IDs to help you future-proof your application in the event that the old format is removed.</p>\n\n<h2 id=\"what-this-migration-does\" translation-result=\"on\">此迁移的作用<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#what-this-migration-does\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"what-this-migration-does\">What this migration does<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#what-this-migration-does\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">Angular 11 版引入了一种用于生成本地化 ID 的新格式。这些新的 ID 比以前的旧格式更健壮。但是，在版本 11 之前创建的应用程序仍然将旧格式用作其 ID。</p><p translation-origin=\"off\">Angular version 11 introduced a new format for generating localization IDs. These new IDs are more robust than the previous legacy format. However, applications created before version 11 still used the legacy format for their IDs.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">你无需将自定义本地化 ID 迁移到新 ID。</p><p translation-origin=\"off\">You do not need to migrate custom localization IDs to new IDs.</p>\n\n</div>\n<p translation-result=\"on\">随着 Angular 版本 12 的发布，你现在可以使用工具将任何旧版的本地化 ID 迁移到基于最新算法的 ID。</p><p translation-origin=\"off\">With the release of Angular version 12, you now have how tools available to help you migrate any legacy localization IDs to IDs that use the latest algorithms.</p>\n\n<p translation-result=\"on\">你有两个用于迁移旧版 ID 的选项。第一种方法使用 Angular CLI 在你的应用程序中定位旧版 ID。第二种方法使用独立脚本 <code>localize-extract</code> 来定位旧版 ID。</p><p translation-origin=\"off\">You have two options for migrating legacy IDs. The first method uses the Angular CLI to locate legacy IDs in your application. The second method uses a standalone script, <code>localize-extract</code>, to locate the legacy IDs.</p>\n\n<h2 id=\"migrating-legacy-ids-using-the-cli\" translation-result=\"on\">使用 CLI 迁移旧版 ID<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrating-legacy-ids-using-the-cli\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"migrating-legacy-ids-using-the-cli\">Migrating legacy IDs using the CLI<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrating-legacy-ids-using-the-cli\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">要使用 CLI 迁移旧版本地化 ID，请执行以下操作：</p><p translation-origin=\"off\">To migrate legacy localization IDs using the CLI:</p>\n\n<ol>\n<li>\n<p translation-result=\"on\">运行 <code>ng extract-i18n</code> 命令。</p><p translation-origin=\"off\">Run the <code>ng extract-i18n</code> command.</p>\n\n<code-example language=\"bash\">\nng extract-i18n --format=legacy-migrate\n</code-example>\n<p translation-result=\"on\">运行此命令后，你将拥有一个迁移文件 <code>messages.json</code>，其中包含旧版本地化 ID 与新版 ID 之间的映射，你可以用它来更新应用程序。</p><p translation-origin=\"off\">After running this command, you have a migration file, <code>messages.json</code>, containing a mapping between legacy localization IDs and new IDs that you can use to update your application.</p>\n\n</li>\n<li>\n<p translation-result=\"on\">用 <code>npx localize-migrate</code> 命令更新应用程序中的 ID。</p><p translation-origin=\"off\">Update the IDs in your application using the <code>npx localize-migrate</code> command.</p>\n\n<code-example language=\"bash\">\nnpx localize-migrate --files=*.xlf --mapFile=messages.json\n</code-example>\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">你还可以在 <code>files</code> 参数中指定其它格式，比如 <code>*.xmb</code>。</p><p translation-origin=\"off\">You can also specify other formats in the <code>files</code> parameter, such as <code>*.xmb</code>.</p>\n\n</div>\n</li>\n<li>\n<p translation-result=\"on\">将更新后的文件提交到你的源码管理系统。</p><p translation-origin=\"off\">Commit the updated files to your source control system.</p>\n\n</li>\n</ol>\n<p translation-result=\"on\">完成迁移后，请将 Angular Compiler 选项 <code>enableI18nLegacyMessageIdFormat</code> 设置为 <code>false</code>。有关此选项的更多信息，请参见<a href=\"/guide/angular-compiler-options#enablei18nlegacymessageidformat\">Angular 编译器选项</a>。</p><p translation-origin=\"off\">After you complete the migration, set the Angular Compiler option, <code>enableI18nLegacyMessageIdFormat</code>, to <code>false</code>. For more information about this option, see <a href=\"/guide/angular-compiler-options#enablei18nlegacymessageidformat\">Angular Compiler Options</a>.</p>\n\n<h2 id=\"migrate-legacy-ids-using-localize-extract\" translation-result=\"on\">用 <code>localize-extract</code> 迁移旧版 ID<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrate-legacy-ids-using-localize-extract\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"migrate-legacy-ids-using-localize-extract\">Migrate legacy IDs using <code>localize-extract</code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-legacy-message-id#migrate-legacy-ids-using-localize-extract\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">如果你未使用 Angular CLI，则可以使用 <code>localize-extract</code> 来迁移旧版本地化 ID：</p><p translation-origin=\"off\">If you are not using the Angular CLI, you can migrate legacy localization IDs using <code>localize-extract</code>:</p>\n\n<ol>\n<li>\n<p translation-result=\"on\">运行 <code>npx localize-extract</code> 命令。</p><p translation-origin=\"off\">Run the <code>npx localize-extract</code> command.</p>\n\n<code-example language=\"bash\">\nnpx localize-extract --format=legacy-migrate --source=./path/to/bundles/**/*.js --outputPath=./messages.json\n</code-example>\n<p translation-result=\"on\">在此命令中，<code>./path/to/bundles/</code> 表示你的可分发文件的路径。你可以将 <code>outputPath</code> 参数设置为系统中的任何目录。</p><p translation-origin=\"off\">In this command, <code>./path/to/bundles/</code> represents the path to your distributable files. You can set the <code>outputPath</code> parameter to any directory in your system.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">一定不能翻译这些可分发文件（例如用 <code>localize-translate</code>），因为这样做会剥离带 <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> 标记的字符串。</p><p translation-origin=\"off\">Your distributable files must not have been translated, such as by using <code>localize-translate</code>, as doing so strips the <code><a href=\"api/localize/init/$localize\" class=\"code-anchor\">$localize</a></code> tagged strings that the extractor requires.</p>\n\n</div>\n<p translation-result=\"on\">运行此命令后，你将拥有一个迁移文件 <code>messages.json</code>，其中包含旧版本地化 ID 与新版 ID 之间的映射，可用于更新应用程序。</p><p translation-origin=\"off\">After running this command, you have a migration file, <code>messages.json</code>, containing a mapping between legacy localization IDs and new IDs that you can use to update your application.</p>\n\n</li>\n<li>\n<p translation-result=\"on\"><code>npx localize-migrate</code> 命令更新应用程序中的 ID。</p><p translation-origin=\"off\">Update the IDs in your application using the <code>npx localize-migrate</code> command.</p>\n\n<code-example language=\"bash\">\nnpx localize-migrate --files=*.xlf --mapFile=messages.json\n</code-example>\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">你还可以在 <code>files</code> 参数中指定其它格式，例如 <code>*.xmb</code>。</p><p translation-origin=\"off\">You can also specify other formats in the <code>files</code> parameter, such as <code>*.xmb</code>.</p>\n\n</div>\n</li>\n</ol>\n<p translation-result=\"on\">完成迁移后，将 Angular Compiler 选项 <code>enableI18nLegacyMessageIdFormat</code> 设置为 <code>false</code>。有关此选项的更多信息，请参见<a href=\"/guide/angular-compiler-options#enablei18nlegacymessageidformat\">Angular 编译器选项</a>。</p><p translation-origin=\"off\">After you complete the migration, set the Angular Compiler option, <code>enableI18nLegacyMessageIdFormat</code>, to <code>false</code>. For more information about this option, see <a href=\"/guide/angular-compiler-options#enablei18nlegacymessageidformat\">Angular Compiler Options</a>.</p>\n\n\n\n  \n</div>\n\n\n<!-- links to this doc:\n - guide/updating-to-version-12\n-->\n<!-- links from this doc:\n - /guide/angular-compiler-options#enablei18nlegacymessageidformat\n - api/localize/init/$localize\n - guide/migration-legacy-message-id#migrate-legacy-ids-using-localize-extract\n - guide/migration-legacy-message-id#migrating-legacy-ids-using-the-cli\n - guide/migration-legacy-message-id#migrating-legacy-localization-ids\n - guide/migration-legacy-message-id#what-this-migration-does\n - guide/migration-legacy-message-id#why-this-migration-is-necessary\n - https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-legacy-message-id.md?message=docs%3A%20请简述你的修改...\n-->"
}