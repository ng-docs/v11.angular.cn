{"id":"guide/migration-update-libraries-tslib","title":"tslib direct dependency migration","contents":"\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-update-libraries-tslib.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"tslib-direct-dependency-migration\" translation-result=\"on\"><code>tslib</code> 直接依赖项迁移<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#tslib-direct-dependency-migration\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\" id=\"tslib-direct-dependency-migration\"><code>tslib</code> direct dependency migration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#tslib-direct-dependency-migration\"><i class=\"material-icons\">link</i></a></h1>\n\n<h2 id=\"what-does-this-migration-do\" translation-result=\"on\">此迁移有什么用？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#what-does-this-migration-do\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"what-does-this-migration-do\">What does this migration do?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#what-does-this-migration-do\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">如果你的工作区中有任何库，此迁移会将它们对 <code>tslib</code> 的平级依赖转换为直接依赖。TypeScript 使用 <code>tslib</code> 包来提供 TypeScript 编译后代码中使用的常用辅助函数。<code>tslib</code> 版本也更新为 <code>2.0.0</code> 以支持 TypeScript 3.9。</p><p translation-origin=\"off\">If you have any libraries within your workspace, this migration will convert <code>tslib</code> peer dependencies to direct dependencies for the libraries.\nTypeScript uses the <code>tslib</code> package to provide common helper functions used in compiled TypeScript code.\nThe <code>tslib</code> version is also updated to <code>2.0.0</code> to support TypeScript 3.9.</p>\n\n<p translation-result=\"on\">之前：</p><p translation-origin=\"off\">Before:</p>\n\n<code-example language=\"json\">\n{\n  \"name\": \"my-lib\",\n  \"version\": \"0.0.1\",\n  \"peerDependencies\": {\n    \"@angular/common\": \"^9.0.0\",\n    \"@angular/core\": \"^9.0.0\",\n    \"tslib\": \"^1.12.0\"\n  }\n}\n</code-example>\n<p translation-result=\"on\">之后：</p><p translation-origin=\"off\">After:</p>\n\n<code-example language=\"json\">\n{\n  \"name\": \"my-lib\",\n  \"version\": \"0.0.1\",\n  \"peerDependencies\": {\n    \"@angular/common\": \"^9.0.0\",\n    \"@angular/core\": \"^9.0.0\"\n  },\n  \"dependencies\": {\n    \"tslib\": \"^2.0.0\"\n  }\n}\n</code-example>\n<h2 id=\"why-is-this-migration-necessary\" translation-result=\"on\">为什么需要进行此迁移？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"why-is-this-migration-necessary\">Why is this migration necessary?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#why-is-this-migration-necessary\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\"><a href=\"https://github.com/Microsoft/tslib\"><code>tslib</code></a> 是 Typescript 的运行时库。该库的版本绑定到了用于编译库的 TypeScript 编译器的版本。平级依赖不能准确表达此运行时库与编译器之间的这种关系。如果 <code>tslib</code> 仍然声明为库对等依赖项，则某些 Angular 工作区可能会出现工作区无法满足 <code>tslib</code> 平级依赖项要求的状态，从而导致构建期或运行期错误。</p><p translation-origin=\"off\">The <a href=\"https://github.com/Microsoft/tslib\"><code>tslib</code></a> is a runtime library for Typescript.\nThe version of this library is bound to the version of the TypeScript compiler used to compile a library.\nPeer dependencies do not accurately represent this relationship between the runtime and the compiler.\nIf <code>tslib</code> remained declared as a library peer dependency, it would be possible for some Angular workspaces to get into a state where the workspace could not satisfy <code>tslib</code> peer dependency requirements for multiple libraries, resulting in build-time or run-time errors.</p>\n\n<p translation-result=\"on\">从 TypeScript 3.9（由 Angular v10 使用）开始，需要 <code>tslib</code> 版本 2.x 来构建新的应用程序。但是，使用以前的 TypeScript 版本构建并已发布到 npm 的较早的库可能需要 <code>tslib</code> 。这种迁移使依赖于 <code>tslib</code> 运行时库的某个不兼容版本的代码可以保持互操作性。</p><p translation-origin=\"off\">As of TypeScript 3.9 (used by Angular v10), <code>tslib</code> version of 2.x is required to build new applications.\nHowever, older libraries built with previous version of TypeScript and already published to npm might need <code>tslib</code> 1.x.\nThis migration makes it possible for code depending on incompatible versions of the <code>tslib</code> runtime library to remain interoperable.</p>\n\n<h2 id=\"do-i-still-need-tslib-as-a-dependency-in-my-workspace-packagejson\" translation-result=\"on\">我是否仍需要 <code>tslib</code> 作为我的工作区 <code>package.json</code> 的依赖项？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#do-i-still-need-tslib-as-a-dependency-in-my-workspace-packagejson\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\" id=\"do-i-still-need-tslib-as-a-dependency-in-my-workspace-packagejson\">Do I still need <code>tslib</code> as a dependency in my workspace <code>package.json</code>?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/migration-update-libraries-tslib#do-i-still-need-tslib-as-a-dependency-in-my-workspace-packagejson\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">是。<code>package.json</code> 文件中声明的 <code>tslib</code> 依赖用于在此工作区内构建应用程序，以及对工作区中的库进行运行单元测试，这是必要的。</p><p translation-origin=\"off\">Yes.\nThe <code>tslib</code> dependency declared in the <code>package.json</code> file of the workspace is used to build applications within this workspace, as well as run unit tests for workspace libraries, and is required.</p>\n\n\n  \n</div>\n\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - guide/migration-update-libraries-tslib#do-i-still-need-tslib-as-a-dependency-in-my-workspace-packagejson\n - guide/migration-update-libraries-tslib#tslib-direct-dependency-migration\n - guide/migration-update-libraries-tslib#what-does-this-migration-do\n - guide/migration-update-libraries-tslib#why-is-this-migration-necessary\n - https://github.com/Microsoft/tslib\n - https://github.com/angular/angular-cn/edit/aio/aio/content/guide/migration-update-libraries-tslib.md?message=docs%3A%20请简述你的修改...\n-->"}